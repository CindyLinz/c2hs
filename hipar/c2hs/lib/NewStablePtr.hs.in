-- @configure_input@   -*-haskell-*-

-- Make sure we have the correct signatures for the New FFI definition.

module NewStablePtr (
  StablePtr, newStablePtr, deRefStablePtr, freeStablePtr, 
  castStablePtrToPtr, castPtrToStablePtr
) where

@BEGIN_NEW_FFI@
import StablePtr (StablePtr, newStablePtr, deRefStablePtr, freeStablePtr, 
		  castStablePtrToPtr, castPtrToStablePtr)
@END_NEW_FFI@


@BEGIN_LEGACY_FFI@

import StablePtr (StablePtr, makeStablePtr, deRefStablePtr, freeStablePtr,
		  addrToStablePtr, stablePtrToAddr)

import Ptr -- we make use of the internal representation of `Ptr' as `Addr'

newStablePtr :: a -> IO (StablePtr a)
newStablePtr  = makeStablePtr

castStablePtrToPtr :: StablePtr a -> Ptr ()
castStablePtrToPtr  = Ptr . stablePtrToAddr

castPtrToStablePtr         :: Ptr () -> StablePtr a
castPtrToStablePtr (Ptr a)  = addrToStablePtr a

@END_LEGACY_FFI@
